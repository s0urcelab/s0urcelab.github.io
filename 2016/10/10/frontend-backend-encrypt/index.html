<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>WEB登录安全课101 | s0urceLab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="当你打开一个网站并试图登录时，背后到底发生了什么？">
<meta property="og:type" content="article">
<meta property="og:title" content="WEB登录安全课101">
<meta property="og:url" content="http://source2git.github.io/2016/10/10/frontend-backend-encrypt/index.html">
<meta property="og:site_name" content="s0urceLab">
<meta property="og:description" content="当你打开一个网站并试图登录时，背后到底发生了什么？">
<meta property="og:updated_time" content="2016-10-17T11:41:10.679Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WEB登录安全课101">
<meta name="twitter:description" content="当你打开一个网站并试图登录时，背后到底发生了什么？">
  
    <link rel="alternate" href="/atom.xml" title="s0urceLab" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer">
      <div id="anitOut"></div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">s0urceLab</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://source2git.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-frontend-backend-encrypt" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/10/frontend-backend-encrypt/" class="article-date">
  <time datetime="2016-10-09T16:00:00.000Z" itemprop="datePublished">2016-10-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      WEB登录安全课101
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>当你打开一个网站并试图登录时，背后到底发生了什么？<br><a id="more"></a></p>
<h3 id="我们先来考虑前端的情况："><a href="#我们先来考虑前端的情况：" class="headerlink" title="我们先来考虑前端的情况："></a>我们先来考虑前端的情况：</h3><h4 id="假设你在进行一个简陋的页面登录"><a href="#假设你在进行一个简陋的页面登录" class="headerlink" title="假设你在进行一个简陋的页面登录"></a>假设你在进行一个简陋的页面登录</h4><ol>
<li>输入账号username、密码passwd</li>
<li>表单提交将username和passwd<strong>明文</strong>post到后台</li>
<li>后台向数据库查询这组用户名密码组合是否存在，并通知前台是否允许登录</li>
</ol>
<h4 id="显然，这听起来一点也不安全，于是你决定加密"><a href="#显然，这听起来一点也不安全，于是你决定加密" class="headerlink" title="显然，这听起来一点也不安全，于是你决定加密"></a>显然，这听起来一点也不安全，于是你决定加密</h4><p>百度一下“加密”，你会发现各种加密算法，应该选择哪一种呢？<br>base64听起来不错，但base64编码是可逆的，这意味着，通过base64加密后的内容是可以直接反算出原文的。<br>显然我们需要一种不可逆的算法，hash听起来不错，这种基于提取信息要素的算法，能生成一组唯一的编码，并且不可逆，常见的md5，sha1等。</p>
<p>假设我们采用md5来加密用户密码，于是发送的密码变成了：<strong>md5(passwd)</strong></p>
<p>现在，攻击者起码得不到明文密码了，但是hash就牢不可破么？显然不是，既然无法逆运算，攻击者想到事先把常见的密码（虽然我们不厌其烦的要求用户设置强度更高的密码，但总有些人喜欢123456或者888888）组合都预先用hash算一遍，储存一个<strong>passwd: md5(passwd)</strong>对应表（AKA：彩虹表），这样只需要拿到<strong>md5(passwd)</strong>就能很快反查到对应的密码明文，于是同样的，我们想到的对策是，加入一个<strong>salt</strong>盐值，这字符串会被附加在用户密码后，一并进行运算，例如<strong>md5(passwd + salt)</strong>，因为盐值是未知的，这样攻击者就无法预先制作彩虹表了（事实上盐值长度强度还有一些要求，也并非无懈可击，扩展阅读<a href="http://blog.sina.com.cn/s/blog_77e8d1350100wfc7.html" target="_blank" rel="external">戳这里</a>）。</p>
<p>现在假设我们使用用户名做盐，我们发送的密码就变成了：<strong>md5(passwd + username)</strong><br>此时虽然攻击者知道我们的盐值，也没办法反查密码明文，可以说是“安全“了一丢丢。</p>
<h4 id="那么为什么上面的“安全”要打引号呢？"><a href="#那么为什么上面的“安全”要打引号呢？" class="headerlink" title="那么为什么上面的“安全”要打引号呢？"></a>那么为什么上面的“安全”要打引号呢？</h4><p>聪明的同学们很快想到，对于后台服务器来说，接收到的只是加密后的密码，这样其实对攻击者来说，根本不需要知道密码明文，只需要用截获到的<strong>md5(passwd + username)</strong>就能伪装成用户进行登录了（AKA：重放攻击），这样看来，不管我们前端使用了怎样的加密算法，最终发送出去的包里，这段<strong>加密信息</strong>总是能够被用来模拟用户骗取服务器信任。再者，前端的加密算法是JS编写的，算法本身对攻击者来说一览无余，另外还有类似JS注入修改、JS劫持等方式让加密算法直接失效。</p>
<p>那么上面写了半天，一点卵用都没有么？<br>并不。<br>虽然我们已经知道，前端加密是一件掩耳盗铃的事，但这依旧是有意义的：<br><del>盆友，听说过撞库么？</del><br>虽然我们都知道，为不同账号设置不一样的密码能有效增加自己账户的安全性，但是我们既不会一目十行也不懂过目不忘，一个账号一个密码没难倒攻击者，先把自己弄懵逼了。很多时候，我们的账号密码都是共用的，那么如果你用这组账号密码注册了10个网站，其中哪怕有1个网站被攻击泄露了数据库，这组账号密码就能被用于登录其他9家网站，显然这很可怕。<br><del>说不准有人还用银行卡密码呢（笑</del><br>那么实际上，作为一家网站，我们不仅对自己的数据库安全负有责任，同时还需要对用户保管在我们数据库里的账号密码负责。<br>那么如果一个入侵者已经拿到了数据库访问权，还有什么能阻止他获得用户的账号密码呢？答案是——只保存加密后的密码。可以说，就算是服务器自己，也不知道密码明文到底是什么，这样就算攻击者拿到我们的库，里面也只有访问本网站的凭证，并不能用来攻击其他网站。</p>
<h3 id="再来说说传输链路层"><a href="#再来说说传输链路层" class="headerlink" title="再来说说传输链路层"></a>再来说说传输链路层</h3><p>说起安全，最不安全的是http协议本身，明文传输内容并且不对发送和接受者做任何的验证，这使得传输链路中任何一个节点都能轻松的读取并修改http数据包，再继续放回链路中传递，也就是监听和截获，可想而知前两年还有网站爆出未作任何处理明文传输账号密码是多么可怕的事，前面已经说了，前端的加密并不能防御这类从链路上发起的攻击，所以我们需要https协议，这种建立在ssl加密层上的通信方式，重点改进了http中存在的两个问题，一是明文传输，二是识别通信双方身份。<br>简而言之，client要提供私钥和server存放的公钥一起作为双方身份的凭证，同时传输的内容也要经过加密，这样一来，首先攻击者伪造的包就能被服务器识别无法实时重放攻击，其次，攻击者截获到的报文，也都是加密后的密文，无法解析。<br>（跟多详情请自行百度关键词https）</p>
<p>坑先挖到这里，关于后端的加密我们下期再见~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://source2git.github.io/2016/10/10/frontend-backend-encrypt/" data-id="ciuslry7l0008zwsitaamb0m3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FrontEnd/">FrontEnd</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/10/20/bus-api/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          武汉实时公交API
        
      </div>
    </a>
  
  
    <a href="/2016/10/04/AMX-ELC-strategy/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">AMX ELC（伪）攻略</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-frontend-backend-encrypt" data-title="WEB登录安全课101" data-url="http://source2git.github.io/2016/10/10/frontend-backend-encrypt/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'s0urce'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  </section>
  </section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FrontEnd/">FrontEnd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WOT/">WOT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/">test</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/FrontEnd/" style="font-size: 20px;">FrontEnd</a> <a href="/tags/WOT/" style="font-size: 10px;">WOT</a> <a href="/tags/test/" style="font-size: 15px;">test</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/10/20/bus-api/">武汉实时公交API</a>
          </li>
        
          <li>
            <a href="/2016/10/10/frontend-backend-encrypt/">WEB登录安全课101</a>
          </li>
        
          <li>
            <a href="/2016/10/04/AMX-ELC-strategy/">AMX ELC（伪）攻略</a>
          </li>
        
          <li>
            <a href="/2016/10/02/some-fragment/">补3个月前的笔记</a>
          </li>
        
          <li>
            <a href="/2016/10/01/test-highlight/">测试代码高亮</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 s0urce<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/cav.js"></script>
<script src="/js/script.js"></script>
  </div>
</body>
</html>